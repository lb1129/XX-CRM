import{aO as $e,aP as Ae,r as h,P as me,l as t,x as he,aj as Ne,s as A,k as se,h as u,ai as xe,aq as ue,K as B,w as Fe,t as s,a8 as Ie,p as Ke,i as We,q as ne,a0 as Le,aQ as Ye,ar as Xe,n as Ze,d as He,m as De,au as ye,aR as qe}from"./index-207b9930.js";import{g as Be,a as Oe}from"./css-06fbc100.js";import{u as Re}from"./useMergedState-460f355e.js";import{d as Qe,D as Je}from"./DialogWrap-75048cfc.js";import{a as re,K as Se}from"./index-36e9620d.js";import{w as Me}from"./raf-8f666c46.js";import{_ as er,L as rr}from"./objectDestructuringEmpty-983c0604.js";import nr from"./RotateLeftOutlined-34124868.js";import tr from"./RotateRightOutlined-5a64680d.js";import ar from"./ZoomInOutlined-b058ff20.js";import ir from"./ZoomOutOutlined-db3c9bc7.js";import{R as or}from"./RightOutlined-9d6dee40.js";import lr from"./EyeOutlined-a70cade2.js";var ur="[object Number]";function sr(o){return typeof o=="number"||$e(o)&&Ae(o)==ur}function vr(o){var e=h(null),l=me(t({},o)),r=h([]),i=function(w){e.value===null&&(r.value=[],e.value=Me(function(){var d;r.value.forEach(function(_){d=t(t({},d),_)}),Ne(l,d),e.value=null})),r.value.push(w)};return he(function(){e.value&&Me.cancel(e.value)}),[l,i]}function ke(o,e,l,r){var i=e+l,n=(l-r)/2;if(l>r){if(e>0)return A({},o,n);if(e<0&&i<r)return A({},o,-n)}else if(e<0||i>r)return A({},o,e<0?n:-n);return{}}function cr(o,e,l,r){var i=Be(),n=i.width,w=i.height,d=null;return o<=n&&e<=w?d={x:0,y:0}:(o>n||e>w)&&(d=t(t({},ke("x",l,o,n)),ke("y",r,e,w))),d}var _e=Symbol("previewGroupContext"),be={provide:function(e){Ke(_e,e)},inject:function(){return We(_e,{isPreviewGroup:h(!1),previewUrls:u(function(){return new Map}),setPreviewUrls:function(){},current:h(null),setCurrent:function(){},setShowPreview:function(){},setMousePosition:function(){},registerImage:null,rootClassName:""})}},fr=se({compatConfig:{MODE:3},name:"PreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String,preview:{type:[Boolean,Object],default:!0},icons:{type:Object,default:function(){return{}}}},setup:function(e,l){var r=l.slots,i=u(function(){var m={visible:void 0,onVisibleChange:function(){},getContainer:void 0,current:0};return xe(e.preview)==="object"?ze(e.preview,m):m}),n=me(new Map),w=h(),d=u(function(){return i.value.visible}),_=u(function(){return i.value.getContainer}),T=function(v,k){var P,O;(P=(O=i.value).onVisibleChange)===null||P===void 0||P.call(O,v,k)},x=Re(!!d.value,{value:d,onChange:T}),C=ue(x,2),$=C[0],p=C[1],y=h(null),Q=u(function(){return d.value!==void 0}),K=u(function(){return Array.from(n.keys())}),b=u(function(){return K.value[i.value.current]}),L=u(function(){return new Map(Array.from(n).filter(function(m){var v=ue(m,2),k=v[1].canPreview;return!!k}).map(function(m){var v=ue(m,2),k=v[0],P=v[1].url;return[k,P]}))}),j=function(v,k){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;n.set(v,{url:k,canPreview:P})},D=function(v){w.value=v},S=function(v){y.value=v},M=function(v,k){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,O=function(){n.delete(v)};return n.set(v,{url:k,canPreview:P}),O},G=function(v){v==null||v.stopPropagation(),p(!1),S(null)};return B(b,function(m){D(m)},{immediate:!0,flush:"post"}),Fe(function(){$.value&&Q.value&&D(b.value)},{flush:"post"}),be.provide({isPreviewGroup:h(!0),previewUrls:L,setPreviewUrls:j,current:w,setCurrent:D,setShowPreview:p,setMousePosition:S,registerImage:M}),function(){var m=Ne({},(er(i.value),i.value));return s(Ie,null,[r.default&&r.default(),s(Ge,t(t({},m),{},{"ria-hidden":!$.value,visible:$.value,prefixCls:e.previewPrefixCls,onClose:G,mousePosition:y.value,src:L.value.get(w.value),icons:e.icons,getContainer:_.value}),null)])}}});const je=fr;var H={x:0,y:0},mr=t(t({},Qe()),{},{src:String,alt:String,rootClassName:String,icons:{type:Object,default:function(){return{}}}}),dr=se({compatConfig:{MODE:3},name:"Preview",inheritAttrs:!1,props:mr,emits:["close","afterClose"],setup:function(e,l){var r=l.emit,i=l.attrs,n=me(e.icons),w=n.rotateLeft,d=n.rotateRight,_=n.zoomIn,T=n.zoomOut,x=n.close,C=n.left,$=n.right,p=h(1),y=h(0),Q=vr(H),K=ue(Q,2),b=K[0],L=K[1],j=function(){return r("close")},D=h(),S=me({originX:0,originY:0,deltaX:0,deltaY:0}),M=h(!1),G=be.inject(),m=G.previewUrls,v=G.current,k=G.isPreviewGroup,P=G.setCurrent,O=u(function(){return m.value.size}),N=u(function(){return Array.from(m.value.keys())}),I=u(function(){return N.value.indexOf(v.value)}),de=u(function(){return k.value?m.value.get(v.value):e.src}),te=u(function(){return k.value&&O.value>1}),ae=h({wheelDirection:0}),W=function(){p.value=1,y.value=0,L(H),r("afterClose")},Y=function(){p.value++,L(H)},ie=function(){p.value>1&&p.value--,L(H)},f=function(){y.value+=90},g=function(){y.value-=90},V=function(a){a.preventDefault(),a.stopPropagation(),I.value>0&&P(N.value[I.value-1])},z=function(a){a.preventDefault(),a.stopPropagation(),I.value<O.value-1&&P(N.value[I.value+1])},U=ne(A({},"".concat(e.prefixCls,"-moving"),M.value)),pe="".concat(e.prefixCls,"-operations-operation"),ve="".concat(e.prefixCls,"-operations-icon"),we=[{icon:x,onClick:j,type:"close"},{icon:_,onClick:Y,type:"zoomIn"},{icon:T,onClick:ie,type:"zoomOut",disabled:u(function(){return p.value===1})},{icon:d,onClick:f,type:"rotateRight"},{icon:w,onClick:g,type:"rotateLeft"}],oe=function(){if(e.visible&&M.value){var a=D.value.offsetWidth*p.value,R=D.value.offsetHeight*p.value,X=Oe(D.value),E=X.left,Z=X.top,F=y.value%180!==0;M.value=!1;var J=cr(F?R:a,F?a:R,E,Z);J&&L(t({},J))}},ge=function(a){a.button===0&&(a.preventDefault(),a.stopPropagation(),S.deltaX=a.pageX-b.x,S.deltaY=a.pageY-b.y,S.originX=b.x,S.originY=b.y,M.value=!0)},ce=function(a){e.visible&&M.value&&L({x:a.pageX-S.deltaX,y:a.pageY-S.deltaY})},fe=function(a){if(e.visible){a.preventDefault();var R=a.deltaY;ae.value={wheelDirection:R}}},Ce=function(a){!e.visible||!te.value||(a.preventDefault(),a.keyCode===Se.LEFT?I.value>0&&P(N.value[I.value-1]):a.keyCode===Se.RIGHT&&I.value<O.value-1&&P(N.value[I.value+1]))},Pe=function(){e.visible&&(p.value!==1&&(p.value=1),(b.x!==H.x||b.y!==H.y)&&L(H))},le=function(){};return he(function(){B([function(){return e.visible},M],function(){le();var c,a,R=re(window,"mouseup",oe,!1),X=re(window,"mousemove",ce,!1),E=re(window,"wheel",fe,{passive:!1}),Z=re(window,"keydown",Ce,!1);try{window.top!==window.self&&(c=re(window.top,"mouseup",oe,!1),a=re(window.top,"mousemove",ce,!1))}catch{}le=function(){R.remove(),X.remove(),E.remove(),Z.remove(),c&&c.remove(),a&&a.remove()}},{flush:"post",immediate:!0}),B([ae],function(){var c=ae.value.wheelDirection;c>0?ie():c<0&&Y()})}),Le(function(){le()}),function(){var c=e.visible,a=e.prefixCls,R=e.rootClassName;return s(Je,t(t({},i),{},{transitionName:"zoom",maskTransitionName:"fade",closable:!1,keyboard:!0,prefixCls:a,onClose:j,afterClose:W,visible:c,wrapClassName:U,rootClassName:R,getContainer:e.getContainer}),{default:function(){return[s("ul",{class:"".concat(e.prefixCls,"-operations")},[we.map(function(E){var Z=E.icon,F=E.onClick,J=E.type,ee=E.disabled;return s("li",{class:ne(pe,A({},"".concat(e.prefixCls,"-operations-operation-disabled"),ee&&(ee==null?void 0:ee.value))),onClick:F,key:J},[Ye(Z,{class:ve})])})]),s("div",{class:"".concat(e.prefixCls,"-img-wrapper"),style:{transform:"translate3d(".concat(b.x,"px, ").concat(b.y,"px, 0)")}},[s("img",{onMousedown:ge,onDblclick:Pe,ref:D,class:"".concat(e.prefixCls,"-img"),src:de.value,alt:e.alt,style:{transform:"scale3d(".concat(p.value,", ").concat(p.value,", 1) rotate(").concat(y.value,"deg)")}},null)]),te.value&&s("div",{class:ne("".concat(e.prefixCls,"-switch-left"),A({},"".concat(e.prefixCls,"-switch-left-disabled"),I.value<=0)),onClick:V},[C]),te.value&&s("div",{class:ne("".concat(e.prefixCls,"-switch-right"),A({},"".concat(e.prefixCls,"-switch-right-disabled"),I.value>=O.value-1)),onClick:z},[$])]}})}}});const Ge=dr;var pr=["icons","maskClassName"],Ve=function(){return{src:String,wrapperClassName:String,wrapperStyle:{type:Object,default:void 0},rootClassName:String,prefixCls:String,previewPrefixCls:String,previewMask:{type:[Boolean,Function],default:void 0},placeholder:Xe.any,fallback:String,preview:{type:[Boolean,Object],default:!0},onClick:{type:Function},onError:{type:Function}}},ze=function(e,l){var r=t({},e);return Object.keys(l).forEach(function(i){e[i]===void 0&&(r[i]=l[i])}),r},wr=0,Ue=se({compatConfig:{MODE:3},name:"Image",inheritAttrs:!1,props:Ve(),emits:["click","error"],setup:function(e,l){var r=l.attrs,i=l.slots,n=l.emit,w=u(function(){return e.prefixCls}),d=u(function(){return"".concat(w.value,"-preview")}),_=u(function(){var f={visible:void 0,onVisibleChange:function(){},getContainer:void 0};return xe(e.preview)==="object"?ze(e.preview,f):f}),T=u(function(){var f;return(f=_.value.src)!==null&&f!==void 0?f:e.src}),x=u(function(){return e.placeholder&&e.placeholder!==!0||i.placeholder}),C=u(function(){return _.value.visible}),$=u(function(){return _.value.getContainer}),p=u(function(){return C.value!==void 0}),y=function(g,V){var z,U;(z=(U=_.value).onVisibleChange)===null||z===void 0||z.call(U,g,V)},Q=Re(!!C.value,{value:C,onChange:y}),K=ue(Q,2),b=K[0],L=K[1];B(b,function(f,g){y(f,g)});var j=h(x.value?"loading":"normal");B(function(){return e.src},function(){j.value=x.value?"loading":"normal"});var D=h(null),S=u(function(){return j.value==="error"}),M=be.inject(),G=M.isPreviewGroup,m=M.setCurrent,v=M.setShowPreview,k=M.setMousePosition,P=M.registerImage,O=h(wr++),N=u(function(){return e.preview&&!S.value}),I=function(){j.value="normal"},de=function(g){j.value="error",n("error",g)},te=function(g){if(!p.value){var V=Oe(g.target),z=V.left,U=V.top;G.value?(m(O.value),k({x:z,y:U})):D.value={x:z,y:U}}G.value?v(!0):L(!0),n("click",g)},ae=function(){L(!1),p.value||(D.value=null)},W=h(null);B(function(){return W},function(){j.value==="loading"&&W.value.complete&&(W.value.naturalWidth||W.value.naturalHeight)&&I()});var Y=function(){};he(function(){B([T,N],function(){if(Y(),!G.value)return function(){};Y=P(O.value,T.value,N.value),N.value||Y()},{flush:"post",immediate:!0})}),Le(function(){Y()});var ie=function(g){return sr(g)?g+"px":g};return function(){var f=e.prefixCls,g=e.wrapperClassName,V=e.fallback,z=e.src,U=e.placeholder,pe=e.wrapperStyle,ve=e.rootClassName,we=r.width,oe=r.height,ge=r.crossorigin,ce=r.decoding,fe=r.alt,Ce=r.sizes,Pe=r.srcset,le=r.usemap,c=r.class,a=r.style,R=_.value,X=R.icons,E=R.maskClassName,Z=Ze(R,pr),F=ne(f,g,ve,A({},"".concat(f,"-error"),S.value)),J=S.value&&V?V:T.value,ee={crossorigin:ge,decoding:ce,alt:fe,sizes:Ce,srcset:Pe,usemap:le,class:ne("".concat(f,"-img"),A({},"".concat(f,"-img-placeholder"),U===!0),c),style:t({height:oe},a)};return s(Ie,null,[s("div",{class:F,onClick:N.value?te:function(Te){n("click",Te)},style:t({width:ie(we),height:ie(oe)},pe)},[s("img",t(t(t({},ee),S.value&&V?{src:V}:{onLoad:I,onError:de,src:z}),{},{ref:W}),null),j.value==="loading"&&s("div",{"aria-hidden":"true",class:"".concat(f,"-placeholder")},[U||i.placeholder&&i.placeholder()]),i.previewMask&&N.value&&s("div",{class:["".concat(f,"-mask"),E]},[i.previewMask()])]),!G.value&&N.value&&s(Ge,t(t({},Z),{},{"aria-hidden":!b.value,visible:b.value,prefixCls:d.value,onClose:ae,mousePosition:D.value,src:J,alt:fe,getContainer:$.value,icons:X,rootClassName:ve}),null)])}}});Ue.PreviewGroup=je;const gr=Ue;var Ee={rotateLeft:s(nr,null,null),rotateRight:s(tr,null,null),zoomIn:s(ar,null,null),zoomOut:s(ir,null,null),close:s(He,null,null),left:s(rr,null,null),right:s(or,null,null)},Cr=se({compatConfig:{MODE:3},name:"AImagePreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String},setup:function(e,l){var r=l.attrs,i=l.slots,n=De("image",e),w=n.getPrefixCls,d=u(function(){return w("image-preview",e.previewPrefixCls)});return function(){return s(je,t(t({},t(t({},r),e)),{},{icons:Ee,previewPrefixCls:d.value}),i)}}});const Pr=Cr;var q=se({name:"AImage",inheritAttrs:!1,props:Ve(),setup:function(e,l){var r=l.slots,i=l.attrs,n=De("image",e),w=n.prefixCls,d=n.rootPrefixCls,_=n.configProvider,T=u(function(){var x=e.preview;if(x===!1)return x;var C=xe(x)==="object"?x:{};return t(t({icons:Ee},C),{},{transitionName:ye(d.value,"zoom",C.transitionName),maskTransitionName:ye(d.value,"fade",C.maskTransitionName)})});return function(){var x,C=((x=_.locale)===null||x===void 0?void 0:x.Image)||qe.Image,$=function(){return s("div",{class:"".concat(w.value,"-mask-info")},[s(lr,null,null),C==null?void 0:C.preview])},p=e.previewMask,y=p===void 0?r.previewMask||$:p;return s(gr,t(t({},t(t(t({},i),e),{},{prefixCls:w.value})),{},{preview:T.value}),t(t({},r),{},{previewMask:typeof y=="function"?y:null}))}}});q.PreviewGroup=Pr;q.install=function(o){return o.component(q.name,q),o.component(q.PreviewGroup.name,q.PreviewGroup),o};const Rr=q;export{Rr as _,Pr as a};
